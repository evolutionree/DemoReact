import React, { PropTypes, Component } from 'react';
import { Button, Popover } from 'antd';
/**
 * 许彩辉(946612604)  10:16:58
{
  "默认头像": [
    "文件：01@3x.png 文件ID：a24201ce-04a9-11e7-a7a4-005056ae7f49 上传完成",
    "文件：02@3x.png 文件ID：a98bb754-04a9-11e7-a7a4-005056ae7f49 上传完成",
    "文件：03@3x.png 文件ID：ae5d0986-04a9-11e7-a7a4-005056ae7f49 上传完成",
    "文件：04@3x.png 文件ID：b1e43ed0-04a9-11e7-a7a4-005056ae7f49 上传完成",
    "文件：05@3x.png 文件ID：b591b45e-04a9-11e7-a7a4-005056ae7f49 上传完成",
    "文件：06@3x.png 文件ID：b97decf4-04a9-11e7-a7a4-005056ae7f49 上传完成",
    "文件：07@3x.png 文件ID：bdda242a-04a9-11e7-a7a4-005056ae7f49 上传完成",
    "文件：08@3x.png 文件ID：c1dc2226-04a9-11e7-a7a4-005056ae7f49 上传完成",
    "文件：09@3x.png 文件ID：c5d98cc4-04a9-11e7-a7a4-005056ae7f49 上传完成",
    "文件：10@3x.png 文件ID：c99305d4-04a9-11e7-a7a4-005056ae7f49 上传完成"
  ],
  "配置用户功能菜单图标": [
    "文件：01@3x.png 文件ID：00000000-0000-0000-0000-100000000001 上传完成",
    "文件：02@3x.png 文件ID：00000000-0000-0000-0000-100000000002 上传完成",
    "文件：03@3x.png 文件ID：00000000-0000-0000-0000-100000000003 上传完成",
    "文件：04@3x.png 文件ID：00000000-0000-0000-0000-100000000004 上传完成",
    "文件：05@3x.png 文件ID：00000000-0000-0000-0000-100000000005 上传完成",
    "文件：06@3x.png 文件ID：00000000-0000-0000-0000-100000000006 上传完成",
    "文件：07@3x.png 文件ID：00000000-0000-0000-0000-100000000007 上传完成",
    "文件：08@3x.png 文件ID：00000000-0000-0000-0000-100000000008 上传完成",
    "文件：09@3x.png 文件ID：00000000-0000-0000-0000-100000000009 上传完成",
    "文件：10@3x.png 文件ID：00000000-0000-0000-0000-100000000010 上传完成"
  ],
  "配置用户选择图标": [
    "文件：01@3x.png 文件ID：00000000-0000-0000-0000-200000000001 上传完成",
    "文件：02@3x.png 文件ID：00000000-0000-0000-0000-200000000002 上传完成",
    "文件：03@3x.png 文件ID：00000000-0000-0000-0000-200000000003 上传完成",
    "文件：04@3x.png 文件ID：00000000-0000-0000-0000-200000000004 上传完成",
    "文件：05@3x.png 文件ID：00000000-0000-0000-0000-200000000005 上传完成",
    "文件：06@3x.png 文件ID：00000000-0000-0000-0000-200000000006 上传完成",
    "文件：07@3x.png 文件ID：00000000-0000-0000-0000-200000000007 上传完成",
    "文件：08@3x.png 文件ID：00000000-0000-0000-0000-200000000008 上传完成",
    "文件：09@3x.png 文件ID：00000000-0000-0000-0000-200000000009 上传完成",
    "文件：10@3x.png 文件ID：00000000-0000-0000-0000-200000000010 上传完成"
  ],
  "消息列表的菜单图标": [
    "文件：workreport@3x.png 文件ID：00000000-0000-0000-0000-300000000001 上传完成",
    "文件：task@3x.png 文件ID：00000000-0000-0000-0000-300000000002 上传完成",
    "文件：sale@3x.png 文件ID：00000000-0000-0000-0000-300000000003 上传完成",
    "文件：approval@3x.png 文件ID：00000000-0000-0000-0000-300000000004 上传完成",
    "文件：announcement@3x.png 文件ID：00000000-0000-0000-0000-300000000005 上传完成",
    "文件：alarm@3x.png 文件ID：00000000-0000-0000-0000-300000000006 上传完成"
  ],
  "客户主页图标": [
    "文件：add@3x.png 文件ID：00000000-0000-0000-0000-400000000001 上传完成",
    "文件：merge@3x.png 文件ID：00000000-0000-0000-0000-400000000002 上传完成",
    "文件：transfer@3x.png 文件ID：00000000-0000-0000-0000-400000000003 上传完成",
    "文件：relation@3x.png 文件ID：00000000-0000-0000-0000-400000000004 上传完成",
    "文件：receivable@3x.png 文件ID：00000000-0000-0000-0000-400000000005 上传完成"
  ]
}
 */
class SelectAppIcon extends Component {
  static propTypes = {
    value: PropTypes.string,
    onChange: PropTypes.func,
    usage: PropTypes.string
  };
  static defaultProps = {};

  constructor(props) {
    super(props);
    this.state = {
      popVisible: false
    };
  }

  renderIconPanel = () => {
    const iconIds1 = [
      '00000000-0000-0000-0000-100000000001',
      '00000000-0000-0000-0000-100000000002',
      '00000000-0000-0000-0000-100000000003',
      '00000000-0000-0000-0000-100000000004',
      '00000000-0000-0000-0000-100000000005',
      '00000000-0000-0000-0000-100000000006',
      '00000000-0000-0000-0000-100000000007',
      '00000000-0000-0000-0000-100000000008',
      '00000000-0000-0000-0000-100000000009',
      '00000000-0000-0000-0000-100000000010'
    ];
    const iconIds2 = [
      '00000000-0000-0000-0000-200000000001',
      '00000000-0000-0000-0000-200000000002',
      '00000000-0000-0000-0000-200000000003',
      '00000000-0000-0000-0000-200000000004',
      '00000000-0000-0000-0000-200000000005',
      '00000000-0000-0000-0000-200000000006',
      '00000000-0000-0000-0000-200000000007',
      '00000000-0000-0000-0000-200000000008',
      '00000000-0000-0000-0000-200000000009',
      '00000000-0000-0000-0000-200000000010'
    ];
    const iconIds4 = [
      '00000000-0000-0000-0000-400000000001',
      '00000000-0000-0000-0000-400000000002',
      '00000000-0000-0000-0000-400000000003',
      '00000000-0000-0000-0000-400000000004',
      '00000000-0000-0000-0000-400000000005',
      '00000000-0000-0000-0000-400000000006',
      '00000000-0000-0000-0000-400000000007',
      '00000000-0000-0000-0000-400000000008',
      '00000000-0000-0000-0000-400000000009',
      '00000000-0000-0000-0000-400000000010',      
      '00000000-0000-0000-0000-400000000011'
    ];    
    const usageMap = {
      0: iconIds2,
      2: iconIds2,
      3: iconIds1,
      4: iconIds4
    };
    const matchedIconIds = usageMap[this.props.usage] || [];
    return (
      <div>
        {matchedIconIds.length ? matchedIconIds.map(id => (
          <img
            key={id}
            style={{ width: '35px', height: '35px', marginRight: '5px', cursor: 'pointer' }}
            onClick={this.selectIcon.bind(this, id)}
            src={`/api/fileservice/read?fileid=${id}`}
            alt=""
          />
        )) : <div>找不到匹配的图标</div>}
      </div>
    );
  };

  selectIcon = id => {
    this.setState({ popVisible: false });
    this.props.onChange(id);
  };

  handleVisibleChange = popVisible => {
    this.setState({ popVisible });
  };

  render() {
    const { value } = this.props;
    return (
      <div>
        {value && (
          <img
            style={{ width: '35px', height: '35px', marginRight: '5px', verticalAlign: 'middle' }}
            src={`/api/fileservice/read?fileid=${value}`}
            alt=""
          />
        )}
        <Popover
          content={this.renderIconPanel()}
          title="选择图标"
          trigger="click"
          visible={this.state.popVisible}
          onVisibleChange={this.handleVisibleChange}
        >
          <Button>选择图标</Button>
        </Popover>
      </div>
    );
  }
}

export default SelectAppIcon;
